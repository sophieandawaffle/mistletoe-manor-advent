<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Christmas Cookie Code</title>
  <link rel="stylesheet" href="/games/design-system.css">
  <style>
        /* Game-specific styles only */
        .story-section {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(71, 85, 105, 0.4);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(20px);
            position: relative;
        }

        .story-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #dc2626, #f59e0b, #059669);
            border-radius: 1rem 1rem 0 0;
        }

        .story-text {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #e2e8f0;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .clues-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .clue-card {
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid rgba(71, 85, 105, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .clue-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
        }

        .clue-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .clue-icon {
            font-size: 1.5rem;
        }

        .clue-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #f1f5f9;
        }

        .clue-content {
            color: #cbd5e1;
            line-height: 1.6;
        }

        .hint-btn {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            color: #93c5fd;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            margin-top: 1rem;
            transition: all 0.3s ease;
            display: block;
            font-family: inherit;
        }

        .hint-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
        }

        .hint-text {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            color: #93c5fd;
            font-size: 0.9rem;
            font-style: italic;
            transition: all 0.3s ease;
        }

        .hint-text.hidden {
            display: none;
        }

        .puzzle-section {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(71, 85, 105, 0.4);
            border-radius: 1rem;
            padding: 2rem;
            margin-top: 2rem;
        }

        .puzzle-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 1rem;
            text-align: center;
        }

        .code-input-section {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin: 2rem 0;
        }

        .code-digit {
            width: 3rem;
            height: 3rem;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(71, 85, 105, 0.4);
            border-radius: 0.5rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #f1f5f9;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .code-digit:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .hint-section {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 0.75rem;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        .hint-section .hint-text {
            color: #93c5fd;
            font-size: 0.9rem;
            font-style: italic;
            background: transparent;
            border: none;
            padding: 0;
            margin: 0;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 0.5rem;
            padding: 0.75rem;
            color: #fca5a5;
            text-align: center;
            margin-top: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .error-message.show {
            opacity: 1;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @media (max-width: 768px) {
            .story-text {
                font-size: 1rem;
            }

            .clues-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .clue-card {
                padding: 1.25rem;
            }

            .code-digit {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1.25rem;
            }

            .puzzle-section {
                padding: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .code-digit {
                width: 2.25rem;
                height: 2.25rem;
                font-size: 1.125rem;
            }
        }
    </style>
 </head>
 <body>
  <div class="container">
   <!-- Animated snowflakes -->
   <div class="snowflake" style="left: 10%; animation-duration: 3s; animation-delay: 0s;">‚ùÑ</div>
   <div class="snowflake" style="left: 20%; animation-duration: 4s; animation-delay: 1s;">‚ùÖ</div>
   <div class="snowflake" style="left: 30%; animation-duration: 3.5s; animation-delay: 0.5s;">‚ùÑ</div>
   <div class="snowflake" style="left: 40%; animation-duration: 5s; animation-delay: 1.8s;">‚ùÖ</div>
   <div class="snowflake" style="left: 50%; animation-duration: 3.2s; animation-delay: 1s;">‚ùÑ</div>
   <div class="snowflake" style="left: 60%; animation-duration: 4.5s; animation-delay: 2s;">‚ùÖ</div>
   <div class="snowflake" style="left: 70%; animation-duration: 3.8s; animation-delay: 0.2s;">‚ùÑ</div>
   <div class="snowflake" style="left: 80%; animation-duration: 4.2s; animation-delay: 1.5s;">‚ùÖ</div>
   <div class="snowflake" style="left: 90%; animation-duration: 3.6s; animation-delay: 0.8s;">‚ùÑ</div>

   <header class="advent-header">
    <div class="day-badge" id="dateLabel">Day 11</div>
    <h1 class="puzzle-title" id="mysteryTitle">The Christmas Cookie Code</h1>
    <p class="mystery-subtitle">Crack the code to recover the stolen cookies!</p>
   </header>

   <main class="puzzle-container" style="max-width: 900px; width: 100%;">
    <div class="story-section">
     <div class="story-text">
      Mrs. Henderson's famous Christmas cookies have been stolen from the town bakery! The thief left behind a cryptic note with three clues. Each clue reveals one digit of the combination to the safe where the cookies are hidden. Can you crack the code and recover the stolen treats?
     </div>
    </div>

    <div class="clues-grid">
     <div class="clue-card">
      <div class="clue-header"><span class="clue-icon">üéÑ</span> <span class="clue-title">Clue #1</span></div>
      <div class="clue-content">
       "How many wise men brought gifts to baby Jesus?" <button class="hint-btn" onclick="toggleHint('hint1')">üí° Need a hint?</button>
       <div class="hint-text hidden" id="hint1"><strong>Hint:</strong> Gold, frankincense, and myrrh were the three gifts brought by the ___</div>
      </div>
     </div>

     <div class="clue-card">
      <div class="clue-header"><span class="clue-icon">üéÖ</span> <span class="clue-title">Clue #2</span></div>
      <div class="clue-content">
       "In 'The Twelve Days of Christmas,' how many turtle doves were given?" <button class="hint-btn" onclick="toggleHint('hint2')">üí° Need a hint?</button>
       <div class="hint-text hidden" id="hint2"><strong>Hint:</strong> "On the second day of Christmas, my true love gave to me..."</div>
      </div>
     </div>

     <div class="clue-card">
      <div class="clue-header"><span class="clue-icon">üïõ</span> <span class="clue-title">Clue #3</span></div>
      <div class="clue-content">
       "How many ghosts visit Ebenezer Scrooge in 'A Christmas Carol'?" <button class="hint-btn" onclick="toggleHint('hint3')">üí° Need a hint?</button>
       <div class="hint-text hidden" id="hint3"><strong>Think:</strong> Past, Present, Future... plus one more at the beginning</div>
      </div>
     </div>
    </div>

    <div class="puzzle-section">
     <h2 class="puzzle-title">Enter the 3-Digit Code</h2>
     <div class="hint-section">
      <div class="hint-text">üí° Solve each clue to get one digit. Enter them in order: Clue 1, Clue 2, Clue 3</div>
     </div>
     <div class="code-input-section">
      <input type="text" class="code-digit" id="digit1" maxlength="1" pattern="[0-9]">
      <input type="text" class="code-digit" id="digit2" maxlength="1" pattern="[0-9]">
      <input type="text" class="code-digit" id="digit3" maxlength="1" pattern="[0-9]">
     </div>
     <button class="submit-button" id="submitBtn">Unlock the Safe</button>
     <div class="error-message" id="errorMessage">Incorrect code! Think carefully about each clue...</div>
    </div>
   </main>

   <div class="success-animation" id="successAnimation"></div>
  </div>

  <script>
        // Correct code: 3 wise men, 2 turtle doves, 4 ghosts (Jacob Marley + 3 Christmas spirits)
        const correctCode = "324";
        let attempts = 0;

        function setupEventListeners() {
            // Auto-advance between input fields
            const digits = ['digit1', 'digit2', 'digit3'];
            digits.forEach((id, index) => {
                const input = document.getElementById(id);
                
                input.addEventListener('input', (e) => {
                    // Only allow numbers
                    e.target.value = e.target.value.replace(/[^0-9]/g, '');
                    
                    // Auto-advance to next field
                    if (e.target.value && index < digits.length - 1) {
                        document.getElementById(digits[index + 1]).focus();
                    }
                });

                input.addEventListener('keydown', (e) => {
                    // Allow backspace to go to previous field
                    if (e.key === 'Backspace' && !e.target.value && index > 0) {
                        document.getElementById(digits[index - 1]).focus();
                    }
                    
                    // Submit on Enter
                    if (e.key === 'Enter') {
                        handleSubmit();
                    }
                });
            });

            // Submit button
            document.getElementById('submitBtn').addEventListener('click', handleSubmit);
        }

        function handleSubmit() {
            const digit1 = document.getElementById('digit1').value;
            const digit2 = document.getElementById('digit2').value;
            const digit3 = document.getElementById('digit3').value;
            
            if (!digit1 || !digit2 || !digit3) {
                showError("Please enter all three digits!");
                return;
            }

            const enteredCode = digit1 + digit2 + digit3;
            const submitBtn = document.getElementById('submitBtn');
            
            // Show loading state
            submitBtn.disabled = true;
            submitBtn.textContent = 'Checking Code...';

            attempts++;

            // Check if code is correct
            if (enteredCode === correctCode) {
                showSuccess();
            } else {
                showError("Incorrect code! Think carefully about each clue...");
            }

            // Reset button
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Unlock the Safe';
            }, 1500);
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
            
            // Shake the input fields
            document.querySelectorAll('.code-digit').forEach(input => {
                input.style.borderColor = '#ef4444';
                input.style.animation = 'shake 0.5s ease-in-out';
            });

            setTimeout(() => {
                errorDiv.classList.remove('show');
                document.querySelectorAll('.code-digit').forEach(input => {
                    input.style.borderColor = '';
                    input.style.animation = '';
                });
            }, 3000);
        }

        function showSuccess() {
            // Mark inputs as correct
            document.querySelectorAll('.code-digit').forEach(input => {
                input.disabled = true;
                input.style.borderColor = '#10b981';
                input.style.background = 'rgba(16, 185, 129, 0.1)';
            });

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Puzzle Completed ‚úì';
            submitBtn.style.background = 'linear-gradient(135deg, #059669 0%, #047857 100%)';

            // Show success feedback
            const feedback = document.createElement('div');
            feedback.className = 'feedback success show';
            feedback.textContent = 'üç™ Excellent detective work! You\'ve cracked the code and recovered Mrs. Henderson\'s Christmas cookies. The town\'s Christmas celebration is saved! üéÑ';
            document.querySelector('.puzzle-section').appendChild(feedback);

            // Create success animation
            createSuccessAnimation();
        }

        function createSuccessAnimation() {
            const animation = document.getElementById('successAnimation');
            const colors = ['#fbbf24', '#f59e0b', '#d97706', '#92400e'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'success-particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = '100%';
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.animationDelay = Math.random() * 0.5 + 's';
                    
                    animation.appendChild(particle);
                    
                    setTimeout(() => {
                        particle.remove();
                    }, 2000);
                }, i * 50);
            }
        }

        // Hint toggle function
        function toggleHint(hintId) {
            const hintElement = document.getElementById(hintId);
            const button = hintElement.previousElementSibling;
            
            if (hintElement.classList.contains('hidden')) {
                hintElement.classList.remove('hidden');
                button.textContent = 'üîç Hide hint';
            } else {
                hintElement.classList.add('hidden');
                button.textContent = 'üí° Need a hint?';
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setupEventListeners();
            document.getElementById('digit1').focus();
        });
    </script>
 </body>
</html>

